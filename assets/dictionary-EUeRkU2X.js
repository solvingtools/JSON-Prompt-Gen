import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css              *//* empty css             *//* empty css               *//* empty css              *//* empty css              */import{D as g,A as y}from"./analyticsService-B6oc-pSV.js";class v{constructor(){this.dictionaryService=new g,this.gaTracker=new y,this.activeCategory=null,this.editingTermId=null,this.dictSidebar=document.getElementById("dict-sidebar"),this.dictSidebarOverlay=document.getElementById("dict-sidebar-overlay"),this.dictHamburgerBtn=document.getElementById("dict-hamburger-btn"),this.dictSidebarClose=document.getElementById("dict-sidebar-close"),this.dictCategoryList=document.getElementById("dict-category-list"),this.dictActiveCategoryTitle=document.getElementById("dict-active-category-title"),this.dictSearchInput=document.getElementById("dict-search"),this.dictContentArea=document.getElementById("dict-content"),this.contributeBtn=document.getElementById("dict-contribute-btn"),this.contributionModal=document.getElementById("contribution-modal"),this.modalCloseBtn=document.getElementById("modal-close-btn"),this.modalCancelBtn=document.getElementById("modal-cancel-btn"),this.modalSubmitBtn=document.getElementById("modal-submit-btn"),this.contribUsername=document.getElementById("contrib-username"),this.contribTermName=document.getElementById("contrib-term-name"),this.contribDefinition=document.getElementById("contrib-definition"),this.contribExamples=document.getElementById("contrib-examples"),this.contribDifficultyPills=document.getElementById("contrib-difficulty-pills"),this.customDropdown=document.getElementById("custom-category-dropdown"),this.dropdownTrigger=document.getElementById("dropdown-trigger"),this.dropdownMenu=document.getElementById("dropdown-menu"),this.dropdownValue=document.querySelector(".dropdown-value"),this.newCategoryNameInput=document.getElementById("new-category-name"),this.selectedCategoryId=null,this.init()}async init(){await this.dictionaryService.init(),this.renderSidebarCategories(),this.bindEvents();const e=this.dictionaryService.getAllCategories();e.length>0?(this.activeCategory=e[0].id,this.selectCategory(this.activeCategory)):this.renderTermsByCategory(null)}bindEvents(){this.dictHamburgerBtn.addEventListener("click",()=>{this.dictSidebar.classList.add("active"),this.dictSidebarOverlay.classList.add("active"),document.body.style.overflow="hidden"});const e=()=>{this.dictSidebar.classList.remove("active"),this.dictSidebarOverlay.classList.remove("active"),document.body.style.overflow=""};this.dictSidebarClose.addEventListener("click",e),this.dictSidebarOverlay.addEventListener("click",e),this.dictSearchInput.addEventListener("input",t=>this.handleSearch(t.target.value)),this.contributeBtn&&this.contributeBtn.addEventListener("click",()=>{this.resetModal(),this.gaTracker.trackEvent("dict_contribute_click"),this.contributionModal.classList.remove("hidden")}),this.modalCloseBtn&&this.modalCloseBtn.addEventListener("click",()=>{this.contributionModal.classList.add("hidden")}),this.modalCancelBtn&&this.modalCancelBtn.addEventListener("click",()=>{this.contributionModal.classList.add("hidden")}),this.modalSubmitBtn&&this.modalSubmitBtn.addEventListener("click",()=>this.handleModalSubmit()),this.contribDifficultyPills&&this.contribDifficultyPills.querySelectorAll(".pill").forEach(t=>{t.addEventListener("click",()=>{this.contribDifficultyPills.querySelectorAll(".pill").forEach(i=>i.classList.remove("active")),t.classList.add("active")})}),this.dropdownTrigger&&this.dropdownTrigger.addEventListener("click",t=>{t.stopPropagation(),this.customDropdown.classList.toggle("open"),this.dropdownMenu.classList.toggle("hidden")}),document.addEventListener("click",t=>{this.customDropdown&&!this.customDropdown.contains(t.target)&&(this.customDropdown.classList.remove("open"),this.dropdownMenu.classList.add("hidden"))})}renderSidebarCategories(){if(!this.dictCategoryList)return;this.dictCategoryList.innerHTML="",this.dictionaryService.getAllCategories().forEach(t=>{const i=document.createElement("li"),n=this.dictionaryService.isCategoryUserCreated(t.id);n&&i.classList.add("user-category");const a=document.createElement("span");if(a.textContent=t.name,a.className="category-name",i.appendChild(a),n){const s=document.createElement("button");s.className="category-delete-btn",s.title="Delete Category",s.innerHTML=`
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="3 6 5 6 21 6"></polyline>
                        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                    </svg>
                `,s.addEventListener("click",o=>{o.stopPropagation(),this.handleDeleteCategory(t.id)}),i.appendChild(s)}i.dataset.catId=t.id,i.addEventListener("click",s=>{s.target.closest(".category-delete-btn")||(this.selectCategory(t.id),this.dictSidebar.classList.remove("active"),this.dictSidebarOverlay.classList.remove("active"),document.body.style.overflow="")}),this.dictCategoryList.appendChild(i)})}selectCategory(e){this.activeCategory=e,this.dictCategoryList.querySelectorAll("li").forEach(i=>{i.classList.remove("active"),i.dataset.catId===e&&i.classList.add("active")});const t=this.dictionaryService.getAllCategories().find(i=>i.id===e);this.dictActiveCategoryTitle.textContent=t?t.name:"Select a Category",this.renderTermsByCategory(e)}renderTermsByCategory(e){if(this.dictContentArea.innerHTML="",!e){this.dictContentArea.innerHTML='<div class="empty-state">Select a category from the sidebar to view terms</div>';return}const t=this.dictionaryService.getTermsByCategory(e);if(t.length===0){this.dictContentArea.innerHTML='<div class="empty-state">No terms in this category yet.</div>';return}t.forEach(i=>{const n=this.createEnhancedTermCard(i);this.dictContentArea.appendChild(n)})}createEnhancedTermCard(e){const t=document.createElement("div"),i=this.dictionaryService.isUserCreated(e.id);t.className=`term-card ${i?"user-term":""}`,t.dataset.termId=e.id;const n=(e.difficulty||"beginner").toLowerCase(),a=e.examples&&e.examples.length>0?`<div class="term-examples">
                <h5>Examples:</h5>
                <ul>${e.examples.map(d=>`<li>${d}</li>`).join("")}</ul>
               </div>`:"",s=e.author||"System",r=JSON.parse(localStorage.getItem("likedTerms")||"[]").includes(e.id);let l=e.likes||0;r&&(l+=1);const u=i?`
            <button class="term-manage-btn edit-btn" title="Edit Term">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                </svg>
            </button>
            <button class="term-manage-btn delete-btn" title="Delete Term">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="3 6 5 6 21 6"></polyline>
                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                </svg>
            </button>
        `:"";t.innerHTML=`
            <div class="term-header">
                <h4 class="term-title">${e.name}</h4>
                <div class="term-header-right">
                    <span class="difficulty-badge ${n}">${n}</span>
                    ${u}
                </div>
            </div>
            <p class="term-definition">${e.definition}</p>
            ${a}
            <div class="term-footer">
                <div class="term-author">By: <span>@${s}</span></div>
                <div class="term-actions">
                    <button class="term-action-btn like-btn ${r?"liked":""}" data-term-id="${e.id}">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="${r?"currentColor":"none"}" stroke="currentColor" stroke-width="2">
                            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                        </svg>
                        <span class="like-count">${l}</span>
                    </button>
                    <button class="btn-use-prompt">Use in Prompt</button>
                </div>
            </div>
        `;const h=t.querySelector(".like-btn");if(h.addEventListener("click",d=>{d.stopPropagation(),this.handleLikeTerm(e.id,h)}),t.querySelector(".btn-use-prompt").addEventListener("click",d=>{d.stopPropagation(),this.handleUseInPrompt(e)}),i){const d=t.querySelector(".edit-btn");d&&d.addEventListener("click",c=>{c.stopPropagation(),this.handleEditTerm(e)});const m=t.querySelector(".delete-btn");m&&m.addEventListener("click",c=>{c.stopPropagation(),this.handleDeleteTerm(e.id)})}return t}handleLikeTerm(e,t){const i=t.classList.toggle("liked"),n=t.querySelector(".like-count");t.querySelector("svg").setAttribute("fill",i?"currentColor":"none");let s=parseInt(n.textContent)||0;i?s++:s=Math.max(0,s-1),n.textContent=s,this.gaTracker.trackEvent("dict_term_like",{termId:e,liked:i});const o=JSON.parse(localStorage.getItem("likedTerms")||"[]");if(i)o.includes(e)||o.push(e);else{const r=o.indexOf(e);r>-1&&o.splice(r,1)}localStorage.setItem("likedTerms",JSON.stringify(o))}handleUseInPrompt(e){localStorage.setItem("pending_dict_term",JSON.stringify(e)),window.location.href="app.html"}handleSearch(e){if(e=e.trim(),e.length>0){this.dictCategoryList.querySelectorAll("li").forEach(i=>i.classList.remove("active")),this.dictActiveCategoryTitle.textContent=`Search: "${e}"`;const t=this.dictionaryService.searchTerm(e);this.renderSearchResults(t)}else this.activeCategory?this.selectCategory(this.activeCategory):this.dictContentArea.innerHTML='<div class="empty-state">Select a category from the sidebar to view terms</div>'}renderSearchResults(e){if(this.dictContentArea.innerHTML="",e.length===0){this.dictContentArea.innerHTML='<div class="empty-state">No terms found matching your query.</div>';return}e.forEach(t=>{const i=document.createElement("div");i.className="search-category-header",i.textContent=t.categoryName,this.dictContentArea.appendChild(i),t.terms.forEach(n=>{const a=this.createEnhancedTermCard(n);this.dictContentArea.appendChild(a)})})}resetModal(){if(this.editingTermId=null,this.contribUsername.value="",this.contribTermName.value="",this.contribDefinition.value="",this.contribExamples.value="",this.newCategoryNameInput.value="",this.newCategoryNameInput.classList.add("hidden"),this.dropdownValue.textContent="Select a category",this.dropdownValue.classList.remove("has-value"),this.selectedCategoryId=this.activeCategory||null,this.populateModalCategories(),this.selectedCategoryId){const e=this.dictionaryService.getAllCategories().find(t=>t.id===this.selectedCategoryId);e&&(this.dropdownValue.textContent=e.name)}this.contribDifficultyPills.querySelectorAll(".pill").forEach(e=>e.classList.remove("active")),this.modalSubmitBtn&&(this.modalSubmitBtn.textContent="Submit Term")}populateModalCategories(){if(!this.dropdownMenu)return;this.dropdownMenu.innerHTML="",this.dictionaryService.getAllCategories().forEach(i=>{const n=document.createElement("div");n.className="dropdown-item",i.id===this.selectedCategoryId&&n.classList.add("selected"),n.textContent=i.name,n.addEventListener("click",()=>{this.selectedCategoryId=i.id,this.dropdownValue.textContent=i.name,this.dropdownValue.classList.add("has-value"),this.newCategoryNameInput.classList.add("hidden"),this.customDropdown.classList.remove("open"),this.dropdownMenu.classList.add("hidden")}),this.dropdownMenu.appendChild(n)});const t=document.createElement("div");t.className="dropdown-item new-category-btn",t.innerHTML=`
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
            Create New Category
        `,t.addEventListener("click",()=>{this.selectedCategoryId="new",this.dropdownValue.textContent="New Category",this.newCategoryNameInput.classList.remove("hidden"),this.newCategoryNameInput.focus(),this.customDropdown.classList.remove("open"),this.dropdownMenu.classList.add("hidden")}),this.dropdownMenu.appendChild(t)}handleModalSubmit(){const e=this.contribTermName.value.trim(),t=this.contribDefinition.value.trim(),i=this.contribUsername.value.trim()||"Anonymous";if(!e||!t||!this.selectedCategoryId){alert("Please fill in all required fields.");return}const n=this.contribDifficultyPills.querySelector(".pill.active"),a=n?n.dataset.value:"intermediate";let s=this.selectedCategoryId;if(s==="new"){const r=this.newCategoryNameInput.value.trim();if(!r){alert("Please enter a name for the new category.");return}s="user_cat_"+Date.now(),this.dictionaryService.addCategory({id:s,name:r,author:i})}const o={name:e,definition:t,difficulty:a,examples:this.contribExamples.value.split(",").map(r=>r.trim()).filter(Boolean),author:i};this.editingTermId?this.dictionaryService.editTerm(s,this.editingTermId,o):this.dictionaryService.addTerm(s,o),this.contributionModal.classList.add("hidden"),this.renderSidebarCategories(),this.selectCategory(s)}handleEditTerm(e){this.editingTermId=e.id,this.contribUsername.value=e.author||"",this.contribTermName.value=e.name,this.contribDefinition.value=e.definition,this.contribExamples.value=e.examples?e.examples.join(", "):"";const i=this.dictionaryService.getTermById(e.id).categoryId;this.selectedCategoryId=i;const n=this.dictionaryService.getAllCategories().find(a=>a.id===i);n&&(this.dropdownValue.textContent=n.name,this.dropdownValue.classList.add("has-value")),this.contribDifficultyPills.querySelectorAll(".pill").forEach(a=>{a.classList.remove("active"),a.dataset.value===e.difficulty&&a.classList.add("active")}),this.contributionModal.classList.remove("hidden"),this.modalSubmitBtn&&(this.modalSubmitBtn.textContent="Update Term")}handleDeleteTerm(e){if(confirm("Are you sure you want to delete this term?")){const t=this.dictionaryService.getTermById(e);t&&(this.dictionaryService.deleteTerm(t.categoryId,e),this.renderTermsByCategory(this.activeCategory))}}handleDeleteCategory(e){confirm("Delete this category and all its terms?")&&(this.dictionaryService.deleteCategory(e),this.renderSidebarCategories(),this.activeCategory===e&&(this.activeCategory=null,this.dictContentArea.innerHTML='<div class="empty-state">Select a category...</div>'))}}document.addEventListener("DOMContentLoaded",()=>{new v});
